<template id="choice-tree-template">
  {{ /* 01. SUMMARY */ }}
  <div>
    <h4>RECAPITULATIF</h4>
    <p>currentChoice: {{store.currentChoice}}</p>
    <ul v-if="store.labelsSteps">
      <li v-for="step in store.labelsSteps">
        <p v-html="step"></p>
      </li>
    </ul>
  </div>
  
  {{ /* 02. CHOICES BLOCK */ }}
  <div v-bind="store.setAllItems(model)">
      <h4>CHOIX</h4>
      <template v-for="(model, index) in store.getChoice()" 
                :key="index">
        <div>
          {{ /* "Reset" button */ }}
          <!--<div v-if="index === 0" 
              class="questionnaire-choice-reset">
            <button type="button" 
                    class="fr-btn sp-btn-link" 
                    :id="`btn-reset-${model.group}`">
              Modifier la s√©lection
            </button>
          </div>-->
          {{ /* Intro */ }}
          <legend v-if="store.allIntros && store.chooseIntro(model.level)" 
              v-html="store.chooseIntro(model.level)"></legend>
          {{ /* Label + Radio button */ }}
          <div v-if="model.label" 
                class="fr-col-12 fr-col-md-6 fr-radio-group fr-radio-group--sm questionnaire-list--item">
            <input type="radio" 
                    data-type="radio"
                    :id="`btn-radio-${model.level}`" 
                    :name="`btn-radio-${model.group}`"
                    @click="store.nextChoice(model.level)">
            <label :for="`btn-radio-${model.level}`" 
                    v-html="model.label"></label>
          </div>
        </div>
      </template>
    </div>
  
  {{ /* 03. RESPONSE */ }}
  <div>
    <h4>REPONSES</h4>
    <p v-if="store.currentResponse">
      {{store.currentResponse}}
    </p>
  </div>
</template>


<script src="/node_modules/petite-vue/dist/petite-vue.umd.js"></script>
<script type="module" src="../js/app.js"></script>
<script>
  (function() {
    var importDoc = document.currentScript.ownerDocument; // importee

    // Define and register <shadow-element>
    // that uses Shadow DOM and a template.
    var proto = Object.create(HTMLElement.prototype);

    proto.createdCallback = function() {
        // get template in import
        var template = importDoc.querySelector('#choice-tree-template');

        // import template into
        var clone = document.importNode(template.content, true);

        var root = this.createShadowRoot();
        root.appendChild(clone);
    };

    document.registerElement('app-template', {prototype: proto});
  })();
</script>